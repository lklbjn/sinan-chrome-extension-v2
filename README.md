# Sinan 书签管理扩展

一个功能强大的 Chrome 书签同步与管理扩展，提供智能搜索、个性化新标签页、暗黑模式和云端同步功能。

## ✨ 核心功能

### 🔍 Omnibox 快速搜索
在浏览器地址栏输入 `bm` + 空格，即可实时搜索所有书签：
- **实时搜索建议**：输入关键词即时显示匹配的书签
- **多种打开方式**：支持当前标签页、新标签页打开
- **最多10个结果**：精准匹配，避免信息过载

### 🏠 个性化新标签页
全新设计的新标签页，替代浏览器默认页面：
- **智能推荐**：基于访问频率显示最常用书签
- **实时搜索**：支持书签名称、网址、描述、标签模糊查找
- **搜索引擎快速访问**：无搜索结果时显示百度、Google、Bing三个搜索引擎
- **响应式布局**：自动适配屏幕尺寸，动态调整显示数量
- **快捷操作**：
  - 左键：当前标签页打开
  - Ctrl/Cmd+左键：新标签页后台打开
  - 中键：新标签页后台打开
  - 回车：使用默认搜索引擎搜索

### 🎨 个性化定制
- **自定义欢迎词**：可配置标题和副标题内容
- **多种背景选项**：
  - 空白背景
  - 本地图片上传
  - Bing每日一图
  - 多个URL随机切换
- **毛玻璃效果**：可调节背景模糊强度
- **默认搜索引擎**：可选择百度、Google、Bing作为默认搜索

### 🔧 扩展管理面板
点击扩展图标的三标签页管理界面：

#### 基础功能
- **欢迎词配置**：自定义新标签页标题和内容
- **默认搜索引擎**：选择百度、Google、Bing
- **背景设置**：选择背景来源和毛玻璃效果
- **图标来源**：选择Google S2或Sinan服务获取网站图标

#### 添加书签
- **当前页面信息**：自动获取标题、网址、描述
- **空间选择**：选择书签存储的命名空间
- **标签管理**：支持多标签选择和记忆上次选择
- **一键添加**：快速将当前页面添加到Sinan

#### 系统配置
- **服务器配置**：设置Sinan服务器地址和API密钥
- **自动同步**：可配置1/5/10/15/30分钟同步间隔
- **手动操作**：立即同步、删除书签目录、打开主页
- **同步状态**：显示最后同步时间和操作结果

### 🌙 主题系统
- **暗黑模式**：支持明暗主题切换
- **系统跟随**：自动检测系统主题偏好
- **持久保存**：主题设置自动保存

### ☁️ 云端同步
- **智能同步**：新建书签自动同步到服务器
- **定时同步**：从服务器拉取最新书签数据
- **智能过滤**：自动排除Sinan文件夹，避免重复同步
- **使用统计**：记录书签访问次数，优化推荐算法
- **缓存机制**：本地缓存提升加载速度

## 📁 项目结构

```
sinan-chrome-extension-v2/
├── src/
│   ├── manifest.json           # Chrome 扩展清单文件 (包含 omnibox 配置)
│   ├── style.css              # 全局样式和主题变量
│   ├── background/
│   │   └── service-worker.js  # 后台脚本 (同步逻辑 + omnibox 事件)
│   ├── shared/                # 共享服务和类型
│   │   ├── services/
│   │   │   ├── api.ts         # API 服务层
│   │   │   ├── storage.ts     # 本地存储服务
│   │   │   └── bookmark.ts    # 书签操作服务
│   │   └── types/
│   │       └── api.ts         # API 类型定义
│   ├── components/            # UI 组件库
│   │   └── ui/
│   │       ├── button/        # 按钮组件
│   │       ├── input/         # 输入框组件
│   │       ├── switch/        # 开关组件
│   │       ├── select/        # 选择器组件
│   │       ├── form/          # 表单组件
│   │       └── alert/         # 提示组件
│   ├── lib/
│   │   └── utils.ts          # 工具函数
│   ├── popup/                # 扩展设置弹窗
│   │   ├── index.html
│   │   └── src/
│   │       ├── App.vue        # 配置管理界面
│   │       └── main.ts
│   ├── option/               # 选项页面
│   │   ├── index.html
│   │   └── src/
│   │       ├── App.vue
│   │       └── main.ts
│   └── newtab/               # 新标签页
│       ├── index.html
│       └── src/
│           ├── App.vue        # 书签展示和搜索界面
│           └── main.ts
├── dist/                     # 构建输出目录
├── vite.config.ts           # Vite 配置
├── tsconfig.json            # TypeScript 配置
└── package.json
```

## 🎯 使用方法

### 📌 初次配置
1. 点击扩展图标，切换到"系统配置"标签页
2. 配置Sinan服务器地址和API密钥
3. 开启自动同步并设置合适的间隔时间
4. 点击"重新同步"按钮初始化书签数据

### 🔍 Omnibox 快速搜索
1. 在浏览器地址栏输入 `bm` 然后按空格
2. 输入书签关键词（名称、网址、描述、标签等）
3. 从下拉建议中选择书签或直接回车打开第一个匹配项

### 🏠 新标签页使用
1. **浏览书签**：打开新标签页自动显示常用书签
2. **搜索书签**：使用顶部搜索框快速查找书签
3. **搜索引擎**：无搜索结果时显示百度、Google、Bing快速搜索
4. **个性化**：
   - 点击右上角按钮切换主题、刷新数据或访问主页
   - 配置自定义欢迎词和背景
   - 设置默认搜索引擎

### 📚 添加书签
1. 点击扩展图标，切换到"添加书签"标签页
2. 自动获取当前页面信息（可手动修改）
3. 选择存储空间和相关标签
4. 点击"添加书签"完成添加

### ⚙️ 个性化配置
1. 切换到"基础功能"标签页
2. **欢迎词设置**：自定义新标签页的标题和副标题
3. **背景设置**：
   - 空白背景：简洁模式
   - 本地图片：上传个人图片
   - Bing每日一图：每日更新的精美图片
   - 多个URL：添加多个图片链接随机显示
4. **毛玻璃效果**：调节背景模糊强度
5. **默认搜索引擎**：选择百度、Google或Bing

## 🚀 安装使用

### 开发环境
- Node.js >= 16
- pnpm (推荐) 或 npm

### 构建安装
```bash
# 克隆项目
git clone <your-repo-url>
cd sinan-chrome-extension-v2

# 安装依赖
pnpm install

# 构建扩展
pnpm build

# 安装到 Chrome
# 1. 打开 chrome://extensions/
# 2. 开启"开发者模式"
# 3. 点击"加载已解压的扩展程序"
# 4. 选择 dist 目录
```

### 开发调试
```bash
# 启动开发服务器
pnpm dev

# 访问调试页面：
# - Popup: http://localhost:5173/src/popup/index.html
# - NewTab: http://localhost:5173/src/newtab/index.html
# - Options: http://localhost:5173/src/option/index.html
```

## 🛠️ 技术栈

- **框架**: Vue 3 + TypeScript
- **构建**: Vite 7.x
- **样式**: Tailwind CSS 4.x
- **组件**: Reka UI + 自定义组件库
- **表单**: vee-validate + zod
- **工具**: @vueuse/core、axios
- **扩展**: Chrome Manifest V3

## 🔧 主要特性

### 🧠 智能推荐系统
- **访问频率分析**：基于使用次数智能排序
- **星标优先**：收藏的书签优先显示
- **缓存机制**：本地缓存加速加载
- **动态布局**：根据屏幕尺寸自动调整显示数量

### 🎯 多种访问方式
- **Omnibox搜索**：地址栏输入 `bm` 快速搜索
- **新标签页**：替换默认新标签页显示常用书签
- **扩展面板**：三标签页配置和管理界面
- **搜索引擎**：无结果时提供百度、Google、Bing搜索

### ☁️ 云端数据同步
- **私有服务器**：支持自托管Sinan服务器
- **智能同步**：自动/手动同步模式
- **增量更新**：避免重复数据传输
- **离线缓存**：网络异常时使用本地缓存

### 🎨 现代化界面
- **响应式设计**：适配各种屏幕尺寸
- **主题系统**：明暗主题自动切换
- **个性化背景**：多种背景选项和毛玻璃效果
- **组件化架构**：Reka UI统一视觉体验

## ⚙️ 配置说明

### Manifest 配置
```json
{
  "manifest_version": 3,
  "name": "Sinan书签管理器",
  "version": "1.2.0",
  "permissions": ["storage", "tabs", "bookmarks", "alarms", "scripting", "activeTab"],
  "omnibox": { "keyword": "bm" },
  "chrome_url_overrides": { "newtab": "src/newtab/index.html" },
  "background": { "service_worker": "background/service-worker.js" },
  "host_permissions": ["<all_urls>"]
}
```

### 权限说明
- **storage**: 保存扩展配置和缓存数据
- **tabs**: 打开和管理标签页
- **bookmarks**: 读写浏览器书签
- **alarms**: 定时同步功能
- **scripting**: 注入脚本获取页面描述信息
- **activeTab**: 访问当前活动标签页
- **host_permissions**: 访问任意网站（用于API请求和图标获取）

## 🔧 开发说明

### 项目架构
- **共享服务层**：`src/shared/` 包含API、存储、缓存等通用服务
- **组件库**：`src/components/ui/` 基于Reka UI的自定义组件
- **多页面应用**：popup、newtab、option三个独立页面
- **类型安全**：完整的TypeScript类型定义

### 主要服务模块
- **api.ts**: Sinan服务器API接口封装
- **storage.ts**: Chrome存储API封装，支持同步和本地存储
- **bookmark.ts**: 浏览器书签操作封装
- **iconCache.ts**: 网站图标缓存管理
- **tagBackground.ts**: 背景图片服务

### 主题定制
在 `src/style.css` 中修改 CSS 变量来定制主题色彩：
```css
:root {
  --primary: 222.2 84% 4.9%;
  --secondary: 210 40% 96%;
  /* 更多主题变量... */
}
```

## ⚠️ 常见问题

### Omnibox不显示建议
- 确认已重新加载扩展
- 检查是否正确输入 `bm` + 空格
- 查看扩展控制台是否有错误
- 确保已配置并同步书签数据

### 同步失败
- 检查服务器地址和API密钥配置
- 确认网络连接正常
- 查看后台脚本日志（chrome://extensions/ > 详细信息 > 查看视图）
- 尝试手动重新同步

### 新标签页无书签
- 首次使用需要先在"系统配置"中配置服务器信息
- 点击"重新同步"按钮初始化数据
- 检查同步状态和错误信息
- 确保有书签数据存在

### 背景图片不显示
- 检查图片URL是否有效
- 确保图片支持跨域访问
- 本地图片需要通过上传功能
- 查看控制台是否有CORS错误

### 添加书签失败
- 确保已配置正确的API密钥
- 检查选择的空间是否存在
- 查看网络连接状态
- 验证当前页面URL是否有效

## 🚀 快速开始

1. **安装扩展**：下载并加载到Chrome
2. **配置服务器**：设置Sinan服务器地址和API密钥
3. **同步书签**：点击"重新同步"初始化数据
4. **个性化设置**：配置欢迎词、背景、搜索引擎
5. **开始使用**：
   - 新标签页浏览常用书签
   - 地址栏输入 `bm` 快速搜索
   - 扩展面板添加当前页面书签

## 📄 许可证

MIT License

---

**🔥 立即体验：地址栏输入 `bm` + 空格开始快速搜索！**
